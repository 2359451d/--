# Content

* [Content](#content)
* [流程](#流程)

# 流程

1.**前端控制器收到请求，调用`doDispatch`处理**

2.根据`HandlerMapping`中保存的请求映射信息找到，**处理当前请求的处理器执行链[HandlerMappings]（包含拦截器**）

3.**根据当前处理器找到适配器**`HandlerAdapter`

4.**拦截器的`preHandle`先执行**

5.**适配器执行目标方法 `ha.handle(...)`，并返回**`ModelAndView`

* `ModelAttribute`注解标注的方法提前运行
  * 直接返回数据（key为返回类型小写），或放在隐含模型中
* 执行目标方法的时候（确定目标方法用的参数）
  * **有注解** (按注解指定的key等来拿)
  * 没注解
    * 看是否`Model，Map`以及其他的
    * 如果是自定义类型
      * **看隐含模型，有就拿** （无注解，默认按入参标识符作为key拿？）
      * 如果没有，看是否是`SessionAttributes`标注的属性
        * 是 - 去session中拿，没有就抛异常
      * 都没有就利用反射创建对象

6.**拦截器的`postHandle`执行**

7.**处理结果（页面渲染流程**）

* **如果有异常 - 异常解析器处理；处理完后返回`ModelAndView`**
* **调用`render`进行页面渲染**
  * 视图解析器（`ViewResolver`实现）根据视图名（包括前缀，所有配置的视图解析器尝试根据视图名得到View对象，得到就返回，不然换下一个视图解析器）的到视图对象 
  * 视图对象`view`调用`render`方法
* **执行拦截器的`AfterCompletion`方法**