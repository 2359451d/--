# 收录

# 1

https://en.wikibooks.org/wiki/SQL_Exercises/The_computer_store

![](/static/2021-02-05-13-16-12.png)

> Select the name of each manufacturer along with the name and price of its most expensive product.

```sql
 /* With a nested SELECT and without INNER JOIN */
   SELECT A.Name, A.Price, F.Name
   FROM Products A, Manufacturers F
   WHERE A.Manufacturer = F.Code
     AND A.Price =
     (
       SELECT MAX(A.Price)
         FROM Products A
         WHERE A.Manufacturer = F.Code
     );
 
 /* With a nested SELECT and an INNER JOIN */
   SELECT A.Name, A.Price, F.Name
   FROM Products A INNER JOIN Manufacturers F
   ON A.Manufacturer = F.Code
     AND A.Price =
     (
       SELECT MAX(A.Price)
         FROM Products A
         WHERE A.Manufacturer = F.Code
     );
```

---

> 17. Select the name of each manufacturer which have an average price above $145 and contain at least 2 different products.

```sql
 Select DISTINCT m.Name as manufacturer_name, m.Code
 FROM Manufacturers m
 JOIN Products p
 ON p.Manufacturer = m.code
 WHERE p.Manufacturer in (
	SELECT DISTINCT p.Manufacturer
	FROM Products p
	GROUP BY p.Manufacturer
	HAVING AVG(p.Price) >= 150 AND COUNT(p.Manufacturer) >=2
);

```

---

# CASE使用

![](/static/2021-02-06-22-56-19.png)

```sql
select name, 
	case when (monthlymaintenance > 100) then
		'expensive'
	else
		'cheap'
	end as cost
	from cd.facilities;   
```