# Some note

已提供g4 Calc文法， `ExecVisitor.java`遍历AST，执行Calc程序

* 每个节点定义一个Exec/visit方法，执行计算，返回值or0

`CalcRun.java` 驱动，main方法，

* 输入Calc源程序，创建lexer（初始化），输入source code file，输出token stream
  * **本身没提供，要通过ANTLR自动生成lexer**
* 创建parser（初始化），解析每个token，输出AST短语
  * **本身没提供，要通过ANTLR自动生成parser**
  * parser提供 `prog()`， 解析整个树
    * 底层顺序访问 `com()`, `expr()`
  * **最后生成AST**
* 初始化 Visitor（可执行计算） & 提供 `visit()`方法
  * `exec.visit(tree)`，执行Calc程序

# ANTLR工具生成Calc lexer & parser

`java -jar antlr-4.9.2-complete.jar -no-listener -visitor src/ast/Calc.g4`
`javac -cp "antlr-4.9.2-complete.jar" -d bin/ -sourcepath src/ src/calc/CalcRun.java`

执行Driver，解释特定calc程序

`java -cp "antlr-4.9.2-complete.jar:bin" calc/CalcRun tests/test1.calc`

---

执行 test2.calc，

java -cp "antlr-4.9.2-complete.jar;bin" calc/CalcRun tests/test2.calc

```
line 4:15 token recognition error at: '/'
line 4:16 extraneous input '2' expecting EOL
```

* 无法识别token /
* `4:15` - line:column

